<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="CSS\ContextMenu.css" type="text/css" />
    
    <link href="CSS\slider.css" rel="stylesheet" type="text/css" />
    <link href="/images/UIPackage/favicon.png" rel="shortcut icon" />
    <meta charset="utf-8" />
    <meta content="width=1280, maximum-scale=1.0" name="viewport" />
    <link href="CSS/module2.css" rel="stylesheet" type="text/css" />
    <meta content="Launchpad by Anima" name="author">
    </meta>
    <script type="text/javascript" src="Javascripts\jquery\jquery-1.7.1.min.js"></script>

    <script type="text/javascript" src="Javascripts/hoops_web_viewer.js"></script>
    <script type="text/javascript" src="Javascripts/communicator_server_integration.js"></script>

    <script type="text/javascript" src="Javascripts\xCheckStudio\CheckManager.js"></script>
    <script type="text/javascript" src="Javascripts\xCheckStudio\HighlightManager.js"></script>
    <script type="text/javascript" src="Javascripts\xCheckStudio\Utility.js"></script>

    <script type="text/javascript" src="Javascripts\xCheckStudio\ReviewModuleViewerInterface.js"></script>
    <script type="text/javascript" src="Javascripts\xCheckStudio\ComparisonReviewManager.js"></script>
    <script type="text/javascript" src="Javascripts\xCheckStudio\ComplianceReviewManager.js"></script>
    <script type="text/javascript" src="Javascripts\xCheckStudio\ReviewModuleStringCollection.js"></script>
    <link href="CSS\analytics.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="CSS\ViewStyle.css" type="text/css" />
    <!-- <link rel="stylesheet" href="CSS\Tablestyle.css" type="text/css" /> -->

    <script src='postData/comparisonCheckpostDataReader.php'></script>
    <script src='postData/sourceAComplianceDataReader.php'></script>
    <script src='postData/sourceBComplianceDataReader.php'></script>
    <script src='postData/sourceAViewerDataReader.php'></script>
    <script src='postData/sourceBViewerDataReader.php'></script>

    <script src='postData/sourceAComponentIdVsComponentDataReader.php'></script>
    <script src='postData/sourceBComponentIdVsComponentDataReader.php'></script>
    <script src='postData/sourceANodeIdVsComponentDataReader.php'></script>
    <script src='postData/sourceBNodeIdVsComponentDataReader.php'></script>

    <script src='postData/SourceASheetDataReader.php'></script>
    <script src='postData/SourceBSheetDataReader.php'></script>

    <script src='postData/analyticsDetailsDataReader.php'></script>

    <link type="text/css" rel="stylesheet" href="Javascripts/jsgrid-1.5.3/css/jsgrid.css" />
    <link type="text/css" rel="stylesheet" href="Javascripts/jsgrid-1.5.3/css/theme.css" />
    <script type="text/javascript" src="Javascripts\jsgrid-1.5.3\dist\jsgrid.js"></script>

    <script type="text/javascript" src="Javascripts\xCheckStudio\GoogleCharts.js"></script>
    <script type="text/javascript" src="Javascripts\xCheckStudio\GoogleLoaderCharts.js"></script>
    <!-- <script type="text/javascript" src="Javascripts\xCheckStudio\PDFExporter.js"></script> -->

    <script type="text/javascript" src="Javascripts\xCheckStudio\AnalyticsManager.js"></script>

    <script type="text/javascript">
        // Load the Visualization API and the corechart package.
        google.charts.load('current', { 'packages': ['corechart'] });   
    </script>

    <style type="text/css">
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: Arial, Helvetica, sans-serif;
        }

        /* The grid: Three equal columns that floats next to each other */
        .column {
            float: left;
            width: 50%;
            padding: 50px;
            text-align: center;
            font-size: 25px;
            cursor: pointer;
            color: white;
        }

        .checkResultsContainerTab {
            padding: 20px;
            color: black;
            overflow: auto;
        }

        .viewContainerTab {
            color: white;
        }

        /* Clear floats after the columns */
        .row:after {
            content: "";
            display: table;
            clear: both;
        }

        /* Closable button inside the container tab */
        .closebtn {
            float: right;
            color: white;
            font-size: 35px;
            cursor: pointer;

        }

        .collapsible {
            background-color: #fff;
            cursor: pointer;
            width: 100%;
            left: 6px;
            height: 20px;
            margin-bottom: 1px;
            border: none;
            text-align: left;
            border: solid 0.5px;
            outline: none;
            font-family: "Helvetica-Bold, Helvetica, Arial, serif";
            font-size: 12px;
        }

        .active,
        .collapsible:hover {
            background-color: lightgray;
        }

        .content {
            padding: 0 18px;
            display: none;
            overflow: hidden;
            background-color: #f1f1f1;
        }

        img.button_open {
            content: url('images/button-open.png');
            cursor: pointer;
        }

        img.button_closed {
            content: url('images/button-closed.png');
            cursor: pointer;
        }

        .scrollable {
            overflow-x: auto;
            overflow-y: auto;
        }

        #ComparisonMainReviewCell,
        #SourceAComplianceMainReviewCell,
        #SourceBComplianceMainReviewCell {
            font-size: 8px;
        }

        #ComparisonDetailedReviewCell,
        #SourceAComplianceDetailedReviewCell,
        #SourceBComplianceDetailedReviewCell {
            font-size: 8px;
        }

        #viewerContainer1,
        #viewerContainer2 {
            font-size: 8px;
            color: #000;
        }

        td {
            height: 10px;
        }

        /* The Modal (background) */
        .modal {
            display: none;
            /* Hidden by default */
            position: absolute;
            /* Stay in place */
            z-index: 1;
            padding: auto;
            /* Location of the box */
            width: 1280px;
            /* Full width */
            height: 760px;
            /* Full height */
            margin: 0 432px 0 0;
            top: 0px;
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        /* Modal Content */
        .modal-content {
            background-color: #fefefe;
            border: 1px solid #888;
            width: 750px;
            height: 740px;
            margin-left: 250px;
            margin-top: 214px;
        }

        /* The Close Button */
        .close {
            color: #aaaaaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .jsgrid-cell {
            word-wrap: break-word;
        }
		
		.disable {
			pointer-events: none;
			opacity: 0.4;
		}
		.disable div,
		.disable textarea {
			overflow: hidden;
		}
    </style>
</head>

<body style="margin: 0;
 background: rgba(255, 255, 255, 1.0);">

    <div id="menu">
        <a href="#" onclick="hide()">
            <img src="images/hide.png" />Hide
            <!-- <span>Ctrl + ?!</span> -->
        </a>
        <a href="#" onclick="showAll()">
            <img src="images/show.png" /> Show All 
            <!-- <span>Ctrl + ?!</span> -->
        </a>

        <hr />
        <a href="#" onclick="setFront()">
             Front 
             <!-- <span>Ctrl + ?!</span> -->
        </a>
        <a href="#" onclick="setBack()">
             Back 
             <!-- <span>Ctrl + ?!</span> -->
        </a>
        <a href="#" onclick="setTop()">
            Top 
            <!-- <span>Ctrl + ?!</span> -->
        </a>
        <a href="#" onclick="setBottom()">
           Bottom 
           <!-- <span>Ctrl + ?!</span> -->
        </a>
        <a href="#" onclick="setRight()">
            Right 
            <!-- <span>Ctrl + ?!</span> -->
        </a>
        <a href="#" onclick="setLeft()">
            Left 
            <!-- <span>Ctrl + ?!</span> -->
        </a>
        <a href="#" onclick="setISO()">
           ISO 
           <!-- <span>Ctrl + ?!</span> -->
        </a>
        <hr />

        <a href="#" onclick="startExplode()">
            Start Explode 
            <!-- <span>Ctrl + ?!</span> -->
        </a>
        <a href="#" onclick="stopExplode()">
             Stop Explode 
             <!-- <span>Ctrl + ?!</span> -->
        </a>

    </div>

    <input id="anPageName" name="page" type="hidden" value="module2" />
    <div class="module2">
        <div style="width: 1280px; height: 100%; position:relative; margin:auto;">
            <div class="bg">
                <div class="bg2">
                </div>
                <img src="/images/UIPackage/landing-page-symbol.png" class="symbol" />
            </div>
            <div class="header">
                <div class="bg2">
                </div>
                <a href="https://www.help.com/" target="_blank">
                    <div class="helpbtn">
                        <img src="/images/UIPackage/module2-bg 2@2x.png" class="bg3" />
                        <img src="/images/UIPackage/prep-home-page-icon@2x.png" class="icon" />
                    </div>
                </a>
                <div class="savebtn">
                    <img src="/images/UIPackage/module2-bg 2@2x.png" class="bg3" />
                    <img src="/images/UIPackage/prep-create-a-configuration-page-icon 1@2x.png" class="icon" />
                </div>
                <div class="refreshbtn" onclick="gotoCheckModule()">
                    <img src="/images/UIPackage/module2-bg 2@2x.png" class="bg3" />
                    <img src="/images/UIPackage/module2-icon 2@2x.png" class="icon" />
                </div>
                <!--<div class="search">
                        <div class="bg3">
                        </div>
                        <div class="typeu2026">
                            Typeâ€¦
                        </div>
                        <img src="/images/UIPackage/create-project-with-open-menu-search-icon@2x.png" class="searchicon" />
                    </div>-->
                <div class="search">
                    <div class="bg3">
                    </div>
                    <input class="typeu2026" id="searchtext" type="text" placeholder="Type..">
                    <img src="/images/UIPackage/create-project-with-open-menu-search-icon@2x.png" class="searchicon" />
                </div>
                <div class="logo">
                    <img src="/images/UIPackage/module2-with-open-menu-check@2x.png" class="check" />
                    <img src="/images/UIPackage/landing-page-studio@2x.png" class="studio" />
                    <img src="/images/UIPackage/module1-symbol 1@2x.png" class="symbol" />
                </div>
            </div>
            <div class="group2">
                <div class="bg2">
                </div>
                <div id="ComparisonDetailedReviewTbody" class="table" style='height:202px;display:none; width: 579px;display:block;'>
                    <!-- <div class="bg3">
                        </div> -->
                    <div class="comments">
                    </div>
                    <div class="adescriptionvalue">
                    </div>
                    <div id="ComparisonDetailedReviewCell" style="border:none; width: 579px; height: 150px"></div>
                    <div id="ComparisonDetailedReviewComment" style="border:none; width: 579px; height:20px; font-size: 10px"></div>
                </div>
                <div id="ComplianceADetailedReviewTbody" class="table" style='height:202px;display:none;'>
                    <!-- <div class="bg3">
                            </div> -->
                    <div class="comments">
                    </div>
                    <div class="adescriptionvalue">
                    </div>
                    <div id="SourceAComplianceDetailedReviewCell" style="border:none; width: 579px; height: 150px"></div>
                    <div id="SourceAComplianceDetailedReviewComment" style="border:none; width: 579px; height:20px; font-size: 10px"></div>
                </div>
                <div id="ComplianceBDetailedReviewTbody" class="table" style='height:202px;display:none;'>
                    <!-- <div class="bg3">
                        </div> -->
                    <div class="comments">
                    </div>
                    <div class="adescriptionvalue">
                    </div>
                    <div id="SourceBComplianceDetailedReviewCell" style="border:none; width: 579px; height: 150px"></div>
                    <div id="SourceBComplianceDetailedReviewComment" style="border:none; width: 579px; height:20px; font-size: 10px"></div>
                </div>
            </div>

            <!-- <img src="/images/UIPackage/module2-bg 3.png" class="bg1" /> -->
            <div class="bg1">
                <!-- <img src="/images/UIPackage/module2-with-open-menu-bitmap.png" class="bitmap" /> -->
                <div class="bitmap">
                    <!--Checks Tab Page-->
                    <div id="ChecksTabPage" class="viewContainerTab" style="width: 100%; height: 110%; display: block;margin-top: 40px;">
                        <!-- <span onclick="this.parentElement.style.display='none'" style="color: black" class="closebtn">&times;</span> -->
                        <div style="height:100%">
                            <table id="checksViewTable" style="width: 100%; height: 200px; margin: auto; overflow: scroll;">

                                <tbody>
                                    <!-- comparison source A viewer -->
                                    <tr id="sourceAContainerRow" style="width: 450px; height: 50%; top: 40px;">
                                        <td style="border-style: none;">   
                                      
                                            <div class="example-canvas-tiny" id="viewerContainer1"
                                                style="width: 550px; height: 270px; min-width: 200px; border-style: none;">
                                                <div id="overlay1" class="sliderOverlay">
                                                    <div class="slidecontainer" style="color:rgba(0, 0, 0, 1)">
                                                        <input type="range" min="0" max="10" value="0" step="0.5" class="slider" id="explodeSlider1">
                                                        <p><span id="explodeValue1"></span></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        </tr>
                                
                                    <!-- comparison source B viewer -->
                                    <tr id="sourceBContainerRow" style="width: 450px; height: 50%; top: 40px;">
                                        <td style="border-style: none;">
                                    
                                            <div class="example-canvas-tiny" id="viewerContainer2"
                                                style="width: 550px; height: 270px; min-width: 200px; border-style: none;">
                                                <div id="overlay2" class="sliderOverlay">
                                                    <div class="slidecontainer" style="color:rgba(0, 0, 0, 1)">
                                                        <input type="range" min="0" max="10" value="0" step="0.5" class="slider" id="explodeSlider2">
                                                        <p> <span id="explodeValue2"></span></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                      

                                </tbody>
                                
                            </table>
                        </div>
                    </div>
                    <!--Analytics Tab Page-->
                    <div id="AnalyticsTabPage" class="viewContainerTab" style="  width: 100%; height: 100%;  display: none">
                        <!-- <span onclick="this.parentElement.style.display='none'" style="color: black" class="closebtn">&times;</span> -->
                        <div id="analyticsContainer" style="margin-top: 50px; height: 110%; width: 100%;"> </div>
                    </div>
                </div>
                <div class="white1">
                    <!-- <img src="/images/UIPackage/module2-bg 7.png" class="bg2" /> -->
                    <div class="panel">
                        <div class="bg3">
                        </div>
                    </div>
                    <div class="tab1" onclick="openViewTab('ChecksTabPage');" style="cursor: pointer;">
                        <!-- <img src="/images/UIPackage/module2-with-open-menu-tab 2@2x.png" class="tab2" /> -->
                        <div class="tab2" id="ChecksViewTab" style=" background-color: #F3F0F4; cursor: pointer;">
                            <div class="checks" onclick="openViewTab('ChecksTabPage');">
                                Checks
                            </div>
                        </div>
                    </div>

                    <div class="tab" onclick="openViewTab('AnalyticsTabPage');" tyle="cursor: pointer;">
                        <!-- <img src="/images/UIPackage/module2-tab 3@2x.png" class="tab1" /> -->
                        <div class="tab1" id="AnalyticsViewTab" style=" background-color: lightgray; cursor: pointer;">
                            <div class="analytics" onclick="openViewTab('AnalyticsTabPage');">
                                Analytics
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="btn-view">
                <div class="review">
                    REVIEW
                </div>
                <!-- <a href="module2withopenmenu.html"> -->
                <div class="btn1">
                    <img src="/images/UIPackage/landing-page-bg 1@2x.png" class="bg2" />
                    <img src="/images/UIPackage/module2-icon-review@2x.png" class="iconreview" />
                </div>
                <!-- </a> -->
                <img src="/images/UIPackage/create-project-arrow@2x.png" class="arrow" />
            </div>
            <div class="footer">
                <div class="bg2">
                </div>
                <div class="inforight">
                    <div class="user">
                        USER
                    </div>
                    <img src="/images/UIPackage/create-project-with-open-menu-bg 2@2x.png" class="bg3" />
                    <div class="path">
                        <img src="/images/UIPackage/landing-page-path@2x.png" class="path1" />
                    </div>
                    <div class="pierre" id="pierre">
                        Pierre
                    </div>
                </div>
            </div>
            <div class="infoleft">
                <div class="project">
                    PROJECT:
                </div>
                <div class="powerplant" id="powerplant">
                    PowerPlant
                </div>
            </div>
            <div class="infomid">
                <div class="units">
                    UNITS:
                </div>

                <select class="mks">
                    <option class="options">Custom</option>
                    <option class="options">Metric</option>
                    <option class="options">Imperial</option>
                </select>
                <!--<img src="/images/UIPackage/module1-with-open-menu-triangle 2@2x.png" class="triangle" />-->
            </div>
            <div class="group3">
                <div class="group1">
                    <div id="ComparisonTabPage" class="checkResultsContainerTab" style="display:block;">
                        <div id="ComparisonMainReviewTbody" class="table1" style='top:10px; height:275px; width: 592px; display:block;overflow-y:scroll;overflow-x: hidden'>
                            <div id="ComparisonMainReviewCell" style="text-align:left; vertical-align:top;width: 575px; height: 275px; border:none">
                            </div>
                        </div>
                    </div>
                    <div id="SourceAComplianceTabPage" class="checkResultsContainerTab" style="display:none;">
                        <div id="SourceAComplianceMainReviewTbody" class="table1" style='top:10px; height:275px; width: 592px; display:block;overflow-y:scroll;overflow-x: hidden'>
                            <div id="SourceAComplianceMainReviewCell" style="text-align:left; vertical-align:top;width: 575px; height: 275px; border:none">
                            </div>
                        </div>
                    </div>
                    <div id="SourceBComplianceTabPage" class="checkResultsContainerTab" style="display:none;">
                        <div id="SourceBComplianceMainReviewTbody" class="table1" style='top:10px; height:275px; width: 592px; display:block;overflow-y:scroll;overflow-x: hidden'>
                            <div id="SourceBComplianceMainReviewCell" style="text-align:left; vertical-align:top;width: 575px; height: 275px; border:none">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="white">
                    <!-- <img src="/images/UIPackage/module2-bg 6.png" class="bg2" /> -->
                    <div class="panel">
                        <div class="bg3">
                        </div>
                    </div>
                    <div class="sourceatab" id="sourceatab">
                        <img src="/images/UIPackage/module2-tab 1@2x.png" class="tab1" />
                    </div>
                    <div class="sourceatab" id="tab1Parent" onclick="openCheckResultTab('ComparisonTabPage');" style="cursor: pointer;">
                        <div class="tab1" id="tab1">
                            <div id="dataSource1ModelBrowserTab" style="text-align: center; background-color: #F3F0F4;">
                                Comparison
                            </div>
                        </div>
                    </div>

                    <div class="sourcebtab" id="sourcebtab">
                        <img src="/images/UIPackage/module2-tab 1@2x.png" class="tab2" />
                    </div>
                    <div class="sourcebtab" id="tab2Parent" onclick="openCheckResultTab('SourceAComplianceTabPage');"
                        style="cursor: pointer;">
                        <div class="tab2" id="tab2" style="cursor: pointer;">
                            <div id="dataSource2ModelBrowserTab" style="text-align: center; background-color: lightgray">
                                Compliance A
                            </div>
                        </div>
                    </div>

                    <div class="sourcectab" id="sourcectab">
                        <img src="/images/UIPackage/module2-tab 1@2x.png" class="tab3" />
                    </div>
                    <div class="sourcectab" id="tab3Parent" onclick="openCheckResultTab('SourceBComplianceTabPage');"
                        style="cursor: pointer;">
                        <div class="tab3" id="tab3">
                            <div id="dataSource3ModelBrowserTab" style="text-align: center; background-color: lightgray">
                                Compliance B
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="group">
                <div class="iconfullscreenfilled" onclick="OnFullScreen()" onMouseOver="this.style.cursor='pointer'">
                    <img src="/images/UIPackage/module1-icon--fullscreen--filled@2x.png" class="iconfullscreenfilled1" />
                </div>
                <div class="iconfullscreenexitfilled">
                    <img src="/images/UIPackage/module2-icon--fullscreen-exit--filled@2x.png" class="iconfullscreenexitfilled1" />
                </div>
                <div class="icon1">
                    <img src="/images/UIPackage/module1-icon-3-bg2@2x.png" class="icon1bg2" />
                    <img src="/images/UIPackage/module2-with-open-menu-icon-1-bg1@2x.png" class="icon1bg1" />
                    <img src="/images/UIPackage/module2-with-open-menu-icon-1-black@2x.png" class="icon1black" />
                </div>
                <div class="icon3">
                    <img src="/images/UIPackage/module1-icon-3-bg2@2x.png" class="icon3bg2" />
                    <img src="/images/UIPackage/module1-with-open-menu-icon-3-black@2x.png" class="icon3black" />
                </div>
            </div>
            <!-- The Modal -->
            <div id="maximizeViewerContainer" class="modal">
                <!-- Modal content -->
                <div class="modal-content" id="maximizeViewerContainer-content" style="width: 750px; height: 740px; margin-left: 280px; margin-top: 5px;">

                </div>
            </div>
        </div>
        
    </div>
    <!-- Scripts -->
    <script>

        document.addEventListener("contextmenu", function (e) {
            e.preventDefault();
        }, false);

        var hiidenEntities = [];

        function hide() {
            if (currentViewer) {

                var results = currentViewer.selectionManager.getResults();
                //currentViewer.model.setNodesVisibilities(boolMap);
                var map = {};
                for (var i = 0; i < results.length; i++) {
                    var selectedItem = results[i];
                    map[selectedItem._nodeId] = false;
                    hiidenEntities.push(selectedItem._nodeId);
                }

                currentViewer.model.setNodesVisibilities(map);
            }
        }

        function showAll() {
            if (currentViewer && hiidenEntities.length > 0) {
                var map = {};
                for (var i = 0; i < hiidenEntities.length; i++) {
                    var hiddenEntity = hiidenEntities[i];
                    map[hiddenEntity] = true;
                }

                currentViewer.model.setNodesVisibilities(map);
                hiidenEntities = [];
            }
        }

        function startExplode() {
            if (currentViewer) {
                var slider;
                var outputFiled;
                var overlayField;
                if (currentViewer._params.containerId === "viewerContainer1") {
                    slider = document.getElementById("explodeSlider1");
                    outputFiled = document.getElementById("explodeValue1");
                    overlayField = document.getElementById("overlay1");

                    overlayField.style.top = "50px";
                }
                else if (currentViewer._params.containerId === "viewerContainer2") {
                    slider = document.getElementById("explodeSlider2");
                    outputFiled = document.getElementById("explodeValue2");
                    overlayField = document.getElementById("overlay2");

                    if (document.getElementById("ComparisonTabPage").style.display === 'block') {
                        overlayField.style.top = "330px";
                    }
                    else {
                        overlayField.style.top = "50px";
                    }
                }
                if (!slider || !outputFiled || !overlayField) {
                    return;
                }

                overlayField.style.display = "block";

                outputFiled.innerHTML = slider.value;               
                overlayField.style.right = "10px";

                slider.oninput = function () {
                    outputFiled.innerHTML = this.value;

                    if (document.getElementById("ComparisonTabPage").style.display === 'block') {
                        if (this.id === "explodeSlider1") {
                            currentViewer =  comparisonReviewManager.SourceAReviewModuleViewerInterface.Viewer;
                        }
                        else if (this.id === "explodeSlider2") {
                            currentViewer =  comparisonReviewManager.SourceBReviewModuleViewerInterface.Viewer;
                        }
                    }                   
                    else if (document.getElementById("SourceAComplianceTabPage").style.display === 'block') {
                        currentViewer =  sourceAComplianceReviewManager.ReviewModuleViewerInterface.Viewer;
                    }
                    else if (document.getElementById("SourceBComplianceTabPage").style.display === 'block') {
                        currentViewer =  sourceBComplianceReviewManager.ReviewModuleViewerInterface.Viewer;
                    }


                    if (currentViewer) {
                        var explodeManager = currentViewer.getExplodeManager();
                        if (explodeManager.getActive()) {
                            explodeManager.stop();
                        }

                        explodeManager.setMagnitude(Number(this.value));
                        explodeManager.start().then(function () {

                        });
                    }

                }

                // var explodeManager = currentViewer.getExplodeManager();
                // explodeManager.setMagnitude(2);
                // explodeManager.start().then(function () {

                // });
            }
        }

        function stopExplode() {

            if (currentViewer) {
                var explodeManager = currentViewer.getExplodeManager();
                if (explodeManager.getActive()) {
                    explodeManager.stop();
                }

                var slider;
                var overlayField;
                if (currentViewer._params.containerId === "viewerContainer1") {
                    slider = document.getElementById("explodeSlider1");
                    overlayField = document.getElementById("overlay1");
                }
                else if (currentViewer._params.containerId === "viewerContainer2") {
                    slider = document.getElementById("explodeSlider2");
                    overlayField = document.getElementById("overlay2");
                }
                if (!slider || !overlayField) {
                    return;
                }
                slider.value = 0;
                overlayField.style.display = "none";
            }

            // if (currentViewer) {
            //     var explodeManager = currentViewer.getExplodeManager();
            //     if (explodeManager.getActive()) {
            //         explodeManager.stop();
            //     }
            // }
        }

        function setFront() {
            if (currentViewer) {
                currentViewer.view.setViewOrientation(Communicator.ViewOrientation.Front, Communicator.DefaultTransitionDuration);
            }
        }
        function setBack() {
            if (currentViewer) {
                currentViewer.view.setViewOrientation(Communicator.ViewOrientation.Back, Communicator.DefaultTransitionDuration);
            }
        }
        function setTop() {
            if (currentViewer) {
                currentViewer.view.setViewOrientation(Communicator.ViewOrientation.Top, Communicator.DefaultTransitionDuration);
            }
        }
        function setBottom() {
            if (currentViewer) {
                currentViewer.view.setViewOrientation(Communicator.ViewOrientation.Bottom, Communicator.DefaultTransitionDuration);
            }
        }
        function setRight() {
            if (currentViewer) {
                currentViewer.view.setViewOrientation(Communicator.ViewOrientation.Right, Communicator.DefaultTransitionDuration);
            }
        }
        function setLeft() {
            if (currentViewer) {
                currentViewer.view.setViewOrientation(Communicator.ViewOrientation.Left, Communicator.DefaultTransitionDuration);
            }
        }
        function setISO() {
            if (currentViewer) {
                currentViewer.view.setViewOrientation(Communicator.ViewOrientation.Iso, Communicator.DefaultTransitionDuration);
            }
        }

        var analyticsManager;;
        window.onload = function () {

            var comparisonCheckManager;
            var sourceAComplianceCheckManager;
            var sourceBComplianceCheckManager;

            var project = getCookie("checkprojectname");
            var powerplantdiv = document.getElementById("powerplant");
            if (project != "" && powerplantdiv != null)
                powerplant.innerHTML = project;

            var username = getCookie("username");
            var pierrediv = document.getElementById("pierre");
            if (username != "" && pierrediv != null)
                pierrediv.innerHTML = username;


            if (typeof ComparisonCheckData !== 'undefined') {

                // restore comparison check data
                comparisonCheckManager = new CheckManager("");
                comparisonCheckManager.restore(ComparisonCheckData)

                // create comparisonreviewmanager
                if (typeof SourceAViewerData !== 'undefined' &&
                    typeof SourceBViewerData !== 'undefined' &&
                    SourceAComponentIdVsComponentData !== 'undefined' &&
                    SourceANodeIdVsComponentData !== 'undefined' &&
                    SourceBComponentIdVsComponentData !== 'undefined' &&
                    SourceBNodeIdVsComponentData !== 'undefined') {
                    comparisonReviewManager = new ComparisonReviewManager(comparisonCheckManager,
                        SourceAViewerData,
                        SourceBViewerData,
                        undefined,
                        undefined,
                        "ComparisonMainReviewCell",
                        "ComparisonDetailedReviewCell",
                        SourceAComponentIdVsComponentData,
                        SourceANodeIdVsComponentData,
                        SourceBComponentIdVsComponentData,
                        SourceBNodeIdVsComponentData);
                }
                else if (typeof SourceAProperties !== 'undefined' && typeof SourceBProperties !== 'undefined') {
                    comparisonReviewManager = new ComparisonReviewManager(comparisonCheckManager,
                        undefined,
                        undefined,
                        SourceAProperties,
                        SourceBProperties,
                        "ComparisonMainReviewCell",
                        "ComparisonDetailedReviewCell",
                        undefined,
                        undefined,
                        undefined,
                        undefined);
                }
                else if (typeof SourceAProperties !== 'undefined' &&
                    typeof SourceBViewerData !== 'undefined' &&
                    SourceBComponentIdVsComponentData !== 'undefined' &&
                    SourceBNodeIdVsComponentData !== 'undefined') {
                    comparisonReviewManager = new ComparisonReviewManager(comparisonCheckManager,
                        undefined,
                        SourceBViewerData,
                        SourceAProperties,
                        undefined,
                        "ComparisonMainReviewCell",
                        "ComparisonDetailedReviewCell",
                        undefined,
                        undefined,
                        SourceBComponentIdVsComponentData,
                        SourceBNodeIdVsComponentData);
                }
                else if (typeof SourceAViewerData !== 'undefined' &&
                    typeof SourceBProperties !== 'undefined' &&
                    SourceAComponentIdVsComponentData !== 'undefined' &&
                    SourceANodeIdVsComponentData !== 'undefined') {
                    comparisonReviewManager = new ComparisonReviewManager(comparisonCheckManager,                       
                        SourceAViewerData,
                        undefined,                       
                        undefined,
                        SourceBProperties,
                        "ComparisonMainReviewCell",
                        "ComparisonDetailedReviewCell",
                        SourceAComponentIdVsComponentData,
                        SourceANodeIdVsComponentData,
                        undefined,
                        undefined);
                }

                // populate review table
                comparisonReviewManager.populateReviewTable();
            }
			else
			{
				$("#tab1Parent").addClass("disable");
			}

            if (typeof SourceAComplianceData !== 'undefined') {

                // restore source A compliance check data
                sourceAComplianceCheckManager = new CheckManager("");
                sourceAComplianceCheckManager.restore(SourceAComplianceData)

                // create sourceAComplianceReviewManager
                if (typeof SourceAProperties !== 'undefined') {
                    sourceAComplianceReviewManager = new ComplianceReviewManager(sourceAComplianceCheckManager,
                        undefined,
                        SourceAProperties,
                        "SourceAComplianceMainReviewCell",
                        "SourceAComplianceDetailedReviewCell",
                        undefined,
                        undefined,
                        "SourceAComplianceDetailedReviewComment");
                }
                else if (typeof SourceAViewerData !== 'undefined') {
                    sourceAComplianceReviewManager = new ComplianceReviewManager(sourceAComplianceCheckManager,
                        SourceAViewerData,
                        undefined,
                        "SourceAComplianceMainReviewCell",
                        "SourceAComplianceDetailedReviewCell",
                        SourceAComponentIdVsComponentData,
                        SourceANodeIdVsComponentData,
                        "SourceAComplianceDetailedReviewComment");
                }


                // populate review table
                sourceAComplianceReviewManager.populateReviewTable();
            }
			else
			{
				$("#tab2Parent").addClass("disable");
			}
            if (typeof SourceBComplianceData !== 'undefined') {

                // restore source A compliance check data
                sourceBComplianceCheckManager = new CheckManager("");
                sourceBComplianceCheckManager.restore(SourceBComplianceData)

                // create sourceBComplianceReviewManager
                if (typeof SourceBProperties !== 'undefined') {
                    sourceBComplianceReviewManager = new ComplianceReviewManager(sourceBComplianceCheckManager,
                        undefined,
                        SourceBProperties,
                        "SourceBComplianceMainReviewCell",
                        "SourceBComplianceDetailedReviewCell",
                        undefined,
                        undefined,
                        "SourceBComplianceDetailedReviewComment");
                }
                else if (typeof SourceBViewerData !== 'undefined') {
                    sourceBComplianceReviewManager = new ComplianceReviewManager(sourceBComplianceCheckManager,
                        SourceBViewerData,
                        undefined,
                        "SourceBComplianceMainReviewCell",
                        "SourceBComplianceDetailedReviewCell",
                        SourceBComponentIdVsComponentData,
                        SourceBNodeIdVsComponentData,
                        "SourceBComplianceDetailedReviewComment");
                }                

                // populate review table
                sourceBComplianceReviewManager.populateReviewTable();
            }
			else
			{
				$("#tab3Parent").addClass("disable");
			}

            // make buttons collapsible
            setButtonsCollapsible();
            // openCheckResultTab("checkResultsContainerTab");
            // remove post data js files from server from earlier check results, if any
            $.ajax({
                data: '',
                url: 'postData/postDataCleaner.php',
                method: 'POST', // or GET
                async: false,
                success: function (msg) {
                    //alert('Post Data files deleted');
                }
            });

            postData(comparisonCheckManager, sourceAComplianceCheckManager, sourceBComplianceCheckManager);

            // trigger comparison tab click manually
            /*/var tab1 = document.getElementById("tab1Parent");
            tab1.click();*/
			if (typeof ComparisonCheckData !== 'undefined') {
                openCheckResultTab('ComparisonTabPage');
                //var tab = document.getElementById("tab1Parent");
                //tab.click();
            }
            else {
                // if (typeof SourceAComplianceData !== 'undefined' && typeof SourceBComplianceData !== 'undefined')
                // {
                // 	openCheckResultTab('SourceAComplianceTabPage');
                // 	// var tab2 = document.getElementById("tab2Parent");
                // 	// tab2.click();
                // }
                // else
                // {
                if (typeof SourceAComplianceData !== 'undefined') {
                    openCheckResultTab('SourceAComplianceTabPage');
                    // var tab3 = document.getElementById("tab3Parent");
                    // tab3.click();
                }
                else if (typeof SourceBComplianceData !== 'undefined') {
                    openCheckResultTab('SourceBComplianceTabPage');
                    // var tab2 = document.getElementById("tab2Parent");
                    // tab2.click();
                }
                //}
            }
        };

        function postData(comparisonCheckManager, sourceAComplianceCheckManager, sourceBComplianceCheckManager) {
            // post comparison data
            if (comparisonCheckManager) {
                $.ajax({
                    url: 'postData/comparisonCheckpostDataWriter.php',
                    type: "POST",
                    async: false,
                    data: { "ComparisonCheckManager": JSON.stringify(comparisonCheckManager) },
                    success: function (data) {
                        // alert("success");
                        //$("#result").html(data);
                    }
                });
            }

            // post source A compliance data
            if (sourceAComplianceCheckManager) {
                $.ajax({
                    url: 'postData/sourceAComplianceDataWriter.php',
                    type: "POST",
                    async: false,
                    data: { "SourceAComplianceCheckManager": JSON.stringify(sourceAComplianceCheckManager) },
                    success: function (data) {
                        //alert("success");
                        //$("#result").html(data);
                    }
                });
            }

            // post source B compliance data
            if (sourceBComplianceCheckManager) {
                $.ajax({
                    url: 'postData/sourceBComplianceDataWriter.php',
                    type: "POST",
                    async: false,
                    data: { "SourceBComplianceCheckManager": JSON.stringify(sourceBComplianceCheckManager) },
                    success: function (data) {
                        //alert("success");
                        //$("#result").html(data);
                    }
                });
            }

            if (typeof AnalyticsData !== 'undefined') {
                $.ajax({
                    url: 'postData/analyticsDetailsDataWriter.php',
                    type: "POST",
                    async: false,
                    data: { "AnalyticsDetailsData": JSON.stringify(AnalyticsData) },
                    success: function (data) {
                        // alert("success");
                    }
                });
            }

        }

        function openViewTab(tabName) {
            var tabs = document.getElementsByClassName("viewContainerTab");
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].style.display = "none";
            }

            document.getElementById(tabName).style.display = "block";

            if (tabName === "AnalyticsTabPage") {
                document.getElementById("AnalyticsViewTab").style.backgroundColor = "#F3F0F4";
                document.getElementById("ChecksViewTab").style.backgroundColor = "lightgray";
                document.getElementById("analyticsContainer").innerHTML='<object type="text/html" data="/analyticsModule.html" style="height: 100%; width: 100%" ></object>';
                // window.open("/analyticsModule.html", 'popUpWindow', 'height=800,width=1500,left=100,top=100, status=yes');

                analyticsManager = new AnalyticsManager();

           
            }
            else if(tabName === "ChecksTabPage")
            {
                document.getElementById("AnalyticsViewTab").style.backgroundColor = "lightgray";
                document.getElementById("ChecksViewTab").style.backgroundColor = "#F3F0F4";
            }
        }

        function setButtonsCollapsible() {
            // add event handler for collapsible rows
            var collapsibleRows = document.getElementsByClassName("collapsible");
            for (var i = 0; i < collapsibleRows.length; i++) {
                collapsibleRows[i].addEventListener("click", function () {
                    this.classList.toggle("active");
                    var content = this.nextElementSibling;
                    if (content.style.display === "block") {
                        content.style.display = "none";
                    } else {
                        content.style.display = "block";
                    }
                });
            }
        }

        function openCheckResultTab(tabName) {
            var tabs = document.getElementsByClassName("checkResultsContainerTab");
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].style.display = "none";
            }

            document.getElementById(tabName).style.display = "block";

            // // clear all contents of checksViewTable
            var checksViewTable = document.getElementById("checksViewTable");
            // checksViewTable.innerHTML = "";

            // // create table rows and viewer containers            
            // var tbody = document.createElement("tbody");
            // checksViewTable.appendChild(tbody);

            var viewerContainer1 = document.getElementById("viewerContainer1");            
            //viewerContainer1.innerHTML = ""
            for(var i = 0; i< viewerContainer1.children.length; i++)
            {
                var childElement = viewerContainer1.children[i];
                if(childElement.id !== "overlay1")
                {
                    viewerContainer1.removeChild(childElement);
                    i--;
                }
                else
                {
                    childElement.style.display = "none";
                    document.getElementById("explodeSlider1").value = 0;
                }
            }
            
            var viewerContainer2 = document.getElementById("viewerContainer2");
            //viewerContainer2.innerHTML = ""
            for(var i = 0; i< viewerContainer2.children.length; i++)
            {
                var childElement = viewerContainer2.children[i];
                if(childElement.id !== "overlay2")
                {
                    viewerContainer2.removeChild(childElement);
                    i--;
                }
                {
                    childElement.style.display = "none";
                    document.getElementById("explodeSlider2").value = 0;
                }
            }

            if (tabName === "ComparisonTabPage") {

                var sourceAComplianceTab = document.getElementById("dataSource2ModelBrowserTab");
                sourceAComplianceTab.style.backgroundColor = "lightgray";
                var sourceBComplianceTab = document.getElementById("dataSource3ModelBrowserTab");
                sourceBComplianceTab.style.backgroundColor = "lightgray";
                var comparisonTab = document.getElementById("dataSource1ModelBrowserTab");
                comparisonTab.style.backgroundColor = "#F3F0F4"

                var comparisonDetailedReviewTab = document.getElementById("ComparisonDetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "block";
                var comparisonDetailedReviewTab = document.getElementById("ComplianceADetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "none";
                var comparisonDetailedReviewTab = document.getElementById("ComplianceBDetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "none";


                var sourceAViewerRow = document.getElementById(sourceAViewerContainerRowId);
                sourceAViewerRow.style.width = "100%";
                sourceAViewerRow.style.height = "50%";
                sourceAViewerRow.style.top = "40px";
                sourceAViewerRow.style.display = "block";

                var sourceBViewerRow = document.getElementById(sourceBViewerContainerRowId);
                sourceBViewerRow.style.width = "100%";
                sourceBViewerRow.style.height = "50%";
                sourceBViewerRow.style.top = "40px";
                sourceBViewerRow.style.display = "block";

              
                // // create row for source a viewer
                // var tr = document.createElement("tr");
                // tr.id = sourceAViewerContainerRowId;
                // tr.style.width = "450px";
                // tr.style.height = "50%";
                // tr.style.top = "40px";
                // //tr.style.borderStyle = "none";
                // tbody.appendChild(tr);

                // var td = document.createElement("td");
                // td.style.borderStyle = "none";
                // tr.appendChild(td);

                // var div = document.createElement("div");
                // div.className = "example-canvas-tiny";
                // div.style.width = "550px";
                // div.style.height = "270px";
                // div.id = sourceAViewerContainerId;
                // div.style.minWidth = "200px";
                // div.style.borderStyle = "none";
                // div.innerHTML = "Source A";
                // td.appendChild(div);

                // // create row for source b viewer
                // tr = document.createElement("tr");
                // tr.id = sourceBViewerContainerRowId;
                // tr.style.width = "450px";
                // tr.style.height = "50%";
                // tr.style.top = "40px";
                // //tr.style.borderStyle = "none";
                // tbody.appendChild(tr);

                // var td = document.createElement("td");
                // td.style.borderStyle = "none";
                // tr.appendChild(td);

                // var div = document.createElement("div");
                // div.className = "example-canvas-tiny";
                // div.style.width = "550px";
                // div.style.height = "270px";
                // div.id = sourceBViewerContainerId;
                // div.style.minWidth = "200px";
                // div.style.borderStyle = "none";
                // div.innerHTML = "Source B";
                // td.appendChild(div);

                //clear highlighted row
                if(comparisonReviewManager.SelectedComponentRowFromSheetA)
                {
                    comparisonReviewManager.unhighlightSelectedSheetRow(comparisonReviewManager.checkStatusArrayA, 
                    comparisonReviewManager.SelectedComponentRowFromSheetA);
                }
                if(comparisonReviewManager.SelectedComponentRowFromSheetB)
                {
                    comparisonReviewManager.unhighlightSelectedSheetRow(comparisonReviewManager.checkStatusArrayB, 
                    comparisonReviewManager.SelectedComponentRowFromSheetB);
                }
                if (comparisonReviewManager.SelectedComponentRow) {
                    comparisonReviewManager.RestoreBackgroundColor(comparisonReviewManager.SelectedComponentRow);
                }
            }
            else if (tabName === "SourceAComplianceTabPage") {

                var sourceAComplianceTab = document.getElementById("dataSource2ModelBrowserTab");
                sourceAComplianceTab.style.backgroundColor = "#F3F0F4";
                var sourceBComplianceTab = document.getElementById("dataSource3ModelBrowserTab");
                sourceBComplianceTab.style.backgroundColor = "lightgray";
                var comparisonTab = document.getElementById("dataSource1ModelBrowserTab");
                comparisonTab.style.backgroundColor = "lightgray"

                var comparisonDetailedReviewTab = document.getElementById("ComparisonDetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "none";
                var comparisonDetailedReviewTab = document.getElementById("ComplianceADetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "block";
                var comparisonDetailedReviewTab = document.getElementById("ComplianceBDetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "none";

                var sourceAViewerRow = document.getElementById(sourceAViewerContainerRowId);
                sourceAViewerRow.style.width = "100%";
                sourceAViewerRow.style.height = "50%";
                sourceAViewerRow.style.margin = "auto";
                sourceAViewerRow.style.display = "block";

                var sourceBViewerRow = document.getElementById(sourceBViewerContainerRowId);
                sourceBViewerRow.style.display = "none";
                // viewerContainer1.innerHTML = ""

                // // create row for source a viewer
                // var tr = document.createElement("tr");
                // tr.id = sourceAViewerContainerRowId;
                // tr.style.width = "100%";
                // tr.style.height = "50%";
                // tr.style.margin = "auto";
                // tbody.appendChild(tr);

                // var td = document.createElement("td");
                // td.style.borderStyle = "none";
                // tr.appendChild(td);

                // var div = document.createElement("div");
                // div.className = "example-canvas-tiny";
                // div.style.width = "550px";
                // div.style.height = "450px";
                // div.style.top = "50px";
                // div.id = sourceAViewerContainerId;
                // div.style.minWidth = "400px";
                // div.style.borderStyle = "none";
                // div.innerHTML = "Source A";
                // td.appendChild(div);

                //clear highlighted row
                if(sourceAComplianceReviewManager.SelectedComponentRowFromSheetA){
                    sourceAComplianceReviewManager.unhighlightSelectedSheetRow(sourceAComplianceReviewManager.checkStatusArray, 
                                                                                 sourceAComplianceReviewManager.SelectedComponentRowFromSheetA);
                }
                if (sourceAComplianceReviewManager.SelectedComponentRow) {
                    sourceAComplianceReviewManager.RestoreBackgroundColor(sourceAComplianceReviewManager.SelectedComponentRow);
                 }
            }
            else if (tabName === "SourceBComplianceTabPage") {
                var sourceAComplianceTab = document.getElementById("dataSource2ModelBrowserTab");
                sourceAComplianceTab.style.backgroundColor = "lightgray";
                var sourceBComplianceTab = document.getElementById("dataSource3ModelBrowserTab");
                sourceBComplianceTab.style.backgroundColor = "#F3F0F4";
                var comparisonTab = document.getElementById("dataSource1ModelBrowserTab");
                comparisonTab.style.backgroundColor = "lightgray"

                var comparisonDetailedReviewTab = document.getElementById("ComparisonDetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "none";
                var comparisonDetailedReviewTab = document.getElementById("ComplianceADetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "none";
                var comparisonDetailedReviewTab = document.getElementById("ComplianceBDetailedReviewTbody");
                comparisonDetailedReviewTab.style.display = "block";

                var sourceBViewerRow = document.getElementById(sourceBViewerContainerRowId);
                sourceBViewerRow.style.width = "100%";
                sourceBViewerRow.style.height = "50%";
                sourceBViewerRow.style.margin = "auto";
                sourceBViewerRow.style.display = "block";

                var sourceAViewerRow = document.getElementById(sourceAViewerContainerRowId);
                sourceAViewerRow.style.display = "none";
                // // create row for source b viewer
                // tr = document.createElement("tr");
                // tr.id = sourceBViewerContainerRowId;
                // tr.style.width = "100%";
                // tr.style.height = "50%";
                // tr.style.margin = "auto";
                // tbody.appendChild(tr);

                // var td = document.createElement("td");
                // td.style.borderStyle = "none";
                // tr.appendChild(td);

                // var div = document.createElement("div");
                // div.className = "example-canvas-tiny";
                // div.style.width = "550px";
                // div.style.height = "450px";
                // div.style.top = "50px";
                // div.id = sourceBViewerContainerId;
                // div.style.minWidth = "400px";
                // div.style.borderStyle = "none";
                // div.innerHTML = "Source B";
                // td.appendChild(div);

                //clear highlighted row
                if(sourceBComplianceReviewManager.SelectedComponentRowFromSheetB){
                    sourceBComplianceReviewManager.unhighlightSelectedSheetRow(sourceBComplianceReviewManager.checkStatusArray, 
                                                                            sourceBComplianceReviewManager.SelectedComponentRowFromSheetB);
                }
                if (sourceBComplianceReviewManager.SelectedComponentRow) {
                    sourceBComplianceReviewManager.RestoreBackgroundColor(sourceBComplianceReviewManager.SelectedComponentRow);
                 }                                                    
            }

            // clear views before loading models into viewers
            if (typeof comparisonReviewManager !== 'undefined') {
                // clear viewer for XMl data source
                if (comparisonReviewManager.SourceAReviewModuleViewerInterface &&
                    comparisonReviewManager.SourceAReviewModuleViewerInterface.Viewer) {

                    comparisonReviewManager.SourceAReviewModuleViewerInterface.Viewer.model.clear();
                }

                if (comparisonReviewManager.SourceBReviewModuleViewerInterface &&
                    comparisonReviewManager.SourceBReviewModuleViewerInterface.Viewer) {
                    comparisonReviewManager.SourceBReviewModuleViewerInterface.Viewer.model.clear();
                }

                // // clear for Excel data source
                // if (document.getElementById(sourceAViewerContainerId) &&
                //     document.getElementById(sourceAViewerContainerId).getElementsByTagName("div")) {
                //     document.getElementById(sourceAViewerContainerId).innerHTML = ""
                // }
                // if (document.getElementById(sourceBViewerContainerId) &&
                //     document.getElementById(sourceBViewerContainerId).getElementsByTagName("div")) {
                //     document.getElementById(sourceBViewerContainerId).innerHTML = ""
                // }
            }
            if (typeof sourceAComplianceReviewManager !== 'undefined') {
                // clear viewer for XMl data source
                if (sourceAComplianceReviewManager.ReviewModuleViewerInterface &&
                    sourceAComplianceReviewManager.ReviewModuleViewerInterface.Viewer) {
                    sourceAComplianceReviewManager.ReviewModuleViewerInterface.Viewer.model.clear();
                }
                // // clear for Excel data source
                // if (document.getElementById(sourceAViewerContainerId) &&
                //     document.getElementById(sourceAViewerContainerId).getElementsByTagName("div")) {
                //     document.getElementById(sourceAViewerContainerId).innerHTML = ""
                // }
            }
            if (typeof sourceBComplianceReviewManager !== 'undefined') {
                // clear viewer for XMl data source
                if (sourceBComplianceReviewManager.ReviewModuleViewerInterface &&
                    sourceBComplianceReviewManager.ReviewModuleViewerInterface.Viewer) {
                    sourceBComplianceReviewManager.ReviewModuleViewerInterface.Viewer.model.clear();
                }
                // // clear for Excel data source
                // if (document.getElementById(sourceBViewerContainerId) &&
                //     document.getElementById(sourceBViewerContainerId).getElementsByTagName("div")) {
                //     document.getElementById(sourceBViewerContainerId).innerHTML = ""
                // }
            }

            // load data sources in viewer
            if (typeof comparisonReviewManager !== 'undefined' && 
                tabName === "ComparisonTabPage") {
                comparisonReviewManager.loadDatasources();
            }
            else if (typeof sourceAComplianceReviewManager !== 'undefined' && 
                     tabName === "SourceAComplianceTabPage") {
                sourceAComplianceReviewManager.loadDatasource();
            }
            else if (typeof sourceBComplianceReviewManager !== 'undefined' && 
                     tabName === "SourceBComplianceTabPage") {
                sourceBComplianceReviewManager.loadDatasource();
            }
        }

        function getCookie(cname) {
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

        function gotoCheckModule() {
            window.location = "/checkModule.html";
            return false;
        }

        function closePopout() {
            if (this._poppedOutWindow) {
                this._poppedOutWindow.close();
                this._poppedOutWindow = null;
                this.returnViewer();
            }
        }


        function returnViewer(viewerdata) {
            // var container = document.getElementById("dataSourceViewer");
            viewerContainer = document.getElementsByClassName("viewContainerTab");
            viewerdata.style.width = "100%"
            viewerdata.style.height = "200px";
            viewerdata.style.margin = "auto";
            viewerdata.style.top = "120px";
            //margin: 20px 0 0 20px
            //viewerContainer[0].appendChild(viewerdata);
            viewerContainer[0].children[0].appendChild(viewerdata);
            var modalViewerContainer = viewerdata.getElementsByClassName("example-canvas-tiny");
            for (var i = 0; i < modalViewerContainer.length; i++) {
                // fileExtension1 = AnalyticsData.SourceAName.split(".")[1];
                // fileExtension2 = AnalyticsData.SourceBName.split(".")[1];
                var currentViewer = modalViewerContainer[i];
                if (document.getElementById("dataSource1ModelBrowserTab").style.backgroundColor !== "lightgray") {
                    currentViewer.style.width = "550px";
                    currentViewer.style.height = "270px";
                    if (modalViewerContainer.length === 1) {
                        currentViewer.style.top = "50px";
                    }
                }
                else {
                    currentViewer.style.width = "550px";
                    currentViewer.style.height = "450px";
                    if (modalViewerContainer.length === 1) {
                        currentViewer.style.top = "50px";
                    }
                }
            }

             // resize viewer canvas
             resizeHoopsViewerCanvas();

            // document.getElementById("ChecksTabPage").style.marginTop = "40px";
            // this._viewer.moveToWindow(window);
            // this._viewer.resizeCanvas();
            // window.setTimeout(function () {
            //     _this._viewer.redraw();
            // }, 500);
        };

        function OnFullScreen() {
            var modal = document.getElementById('maximizeViewerContainer');
            // When the user clicks the button, open the modal 
            modal.style.display = "block";
            if (document.getElementById("ChecksViewTab").style.backgroundColor === "rgb(243, 240, 244)") {
                var viewerdata = document.getElementById("checksViewTable")
                var modalViewer = document.getElementById("maximizeViewerContainer-content");
                modalViewer.innerHTML = "";
                modalViewer.appendChild(viewerdata);

                viewerdata.style.width = "100%";
                viewerdata.style.height = "100%";
                viewerdata.style.margin = "auto";
                modalViewer.style.marginLeft = "280px";


                var modalViewerContainer = viewerdata.getElementsByClassName("example-canvas-tiny");
                for (var i = 0; i < modalViewerContainer.length; i++) {
                    var currentViewer = modalViewerContainer[i];
                    currentViewer.style.width = "745px";
                    currentViewer.style.height = "370px";
                    currentViewer.style.top = "0px";
                    modalViewer.style.marginTop = "10px"
                    if (modalViewerContainer.length === 1) {
                        currentViewer.style.top = "0px";
                        modalViewer.style.marginTop = "195px"
                        modalViewer.style.width = "745px"
                        modalViewer.style.height = "370px"
                    }
                }

                // resize viewer canvas
                resizeHoopsViewerCanvas();
            }
            else if(document.getElementById("AnalyticsViewTab").style.backgroundColor === "rgb(243, 240, 244)"){
                var analyticsContainerElement = document.getElementById("analyticsContainer");
                var modalViewer = document.getElementById("maximizeViewerContainer-content");
                modalViewer.innerHTML = "";
                modalViewer.appendChild(analyticsContainerElement);
                modalViewer.style.marginLeft = "20px";
                modalViewer.style.marginTop = "10px";
                modalViewer.style.height = "750px";
                var modalAnalyticsContainer = modalViewer.children[0]//modalViewer.getElementById("analyticsContainer");
                modalAnalyticsContainer.style.height = "743px";
                modalAnalyticsContainer.style.width = "165%";
                modalAnalyticsContainer.style.marginTop = "0px";
            }
        }

        function resizeHoopsViewerCanvas()
        {
            if(document.getElementById("ComparisonDetailedReviewTbody").style.display === "block" &&
                   comparisonReviewManager !== undefined &&
                    comparisonReviewManager.SourceAReviewModuleViewerInterface &&
                    comparisonReviewManager.SourceAReviewModuleViewerInterface.Viewer &&
                    comparisonReviewManager.SourceBReviewModuleViewerInterface &&
                    comparisonReviewManager.SourceBReviewModuleViewerInterface.Viewer)
                {
                    comparisonReviewManager.SourceAReviewModuleViewerInterface.Viewer.resizeCanvas();
                    comparisonReviewManager.SourceBReviewModuleViewerInterface.Viewer.resizeCanvas();
                }
                else if(document.getElementById("ComplianceADetailedReviewTbody").style.display === "block" &&
                        sourceAComplianceReviewManager !== undefined &&
                        sourceAComplianceReviewManager.ReviewModuleViewerInterface &&
                        sourceAComplianceReviewManager.ReviewModuleViewerInterface.Viewer)
                {
                    sourceAComplianceReviewManager.ReviewModuleViewerInterface.Viewer.resizeCanvas();
                }
                else if(document.getElementById("ComplianceBDetailedReviewTbody").style.display === "block" &&
                        sourceBComplianceReviewManager !== undefined &&
                        sourceBComplianceReviewManager.ReviewModuleViewerInterface &&
                        sourceBComplianceReviewManager.ReviewModuleViewerInterface.Viewer)
                {
                    sourceBComplianceReviewManager.ReviewModuleViewerInterface.Viewer.resizeCanvas();
                }
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            var modal = document.getElementById('maximizeViewerContainer');
            if (event.target == modal) {
                if (document.getElementById("ChecksViewTab").style.backgroundColor === "rgb(243, 240, 244)") {
                    var viewerdata = document.getElementById("checksViewTable")
                    returnViewer(viewerdata);
                }
                else if(document.getElementById("AnalyticsViewTab").style.backgroundColor === "rgb(243, 240, 244)"){
                    var analyticsContainerElement  = document.getElementById("analyticsContainer").innerHTML;
                    var analyticsDiv = document.createElement("DIV");
                    analyticsDiv.id = "analyticsContainer";
                    document.getElementById("AnalyticsTabPage").appendChild(analyticsDiv);
                    document.getElementById("analyticsContainer").innerHTML = analyticsContainerElement;
                    analyticsDiv.style.height = "110%";
                    analyticsDiv.style.width = "100%";
                    analyticsDiv.style.marginTop = "50px";
                    document.getElementById("ChecksTabPage").style.marginTop = "40px";

                    // document.getElementById("analyticsContainer").innerHTML='<object type="text/html" data="/analyticsModule.html" style="height: 100%; width: 100%" ></object>';
                }
               
                modal.style.display = "none";
            }

            var i = document.getElementById("menu").style;
            if (i.visibility === "visible") {
                i.visibility = "hidden";
               // currentViewer = undefined;
            }
        }

        anima_isHidden = function (e) {
            if (!(e instanceof HTMLElement)) return !1;
            if (getComputedStyle(e).display == "none") return !0; else if (e.parentNode && anima_isHidden(e.parentNode)) return !0;
            return !1;
        };
        anima_loadAsyncSrcForTag = function (tag) {
            var elements = document.getElementsByTagName(tag);
            var toLoad = [];
            for (var i = 0; i < elements.length; i++) {
                var e = elements[i];
                var src = e.getAttribute("src");
                var loaded = (src != undefined && src.length > 0 && src != 'data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==');
                if (loaded) continue;
                var asyncSrc = e.getAttribute("src");
                if (asyncSrc == undefined || asyncSrc.length == 0) continue;
                if (anima_isHidden(e)) continue;
                toLoad.push(e);
            }
            toLoad.sort(function (a, b) {
                return anima_getTop(a) - anima_getTop(b);
            });
            for (var i = 0; i < toLoad.length; i++) {
                var e = toLoad[i];
                var asyncSrc = e.getAttribute("src");
                e.setAttribute("src", asyncSrc);
            }
        };
        anima_pauseHiddenVideos = function (tag) {
            var elements = document.getElementsByTagName("video");
            for (var i = 0; i < elements.length; i++) {
                var e = elements[i];
                var isPlaying = !!(e.currentTime > 0 && !e.paused && !e.ended && e.readyState > 2);
                var isHidden = anima_isHidden(e);
                if (!isPlaying && !isHidden && e.getAttribute("autoplay") == "autoplay") {
                    e.play();
                } else if (isPlaying && isHidden) {
                    e.pause();
                }
            }
        };
        anima_loadAsyncSrc = function (tag) {
            anima_loadAsyncSrcForTag("img");
            anima_loadAsyncSrcForTag("iframe");
            anima_loadAsyncSrcForTag("video");
            anima_pauseHiddenVideos();
        };
        var anima_getTop = function (e) {
            var top = 0;
            do {
                top += e.offsetTop || 0;
                e = e.offsetParent;
            } while (e);
            return top;
        };
        anima_loadAsyncSrc();
        anima_old_onResize = window.onresize;
        anima_new_onResize = undefined;
        anima_updateOnResize = function () {
            if (anima_new_onResize == undefined || window.onresize != anima_new_onResize) {
                anima_new_onResize = function (x) {
                    if (anima_old_onResize != undefined) anima_old_onResize(x);
                    anima_loadAsyncSrc();
                };
                window.onresize = anima_new_onResize;
                setTimeout(function () {
                    anima_updateOnResize();
                }, 3000);
            }
        };
        anima_updateOnResize();
        setTimeout(function () {
            anima_loadAsyncSrc();
        }, 200);
    </script>
    <!-- End of Scripts -->
</body>

</html>