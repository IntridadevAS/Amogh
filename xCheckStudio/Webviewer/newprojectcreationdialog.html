<!DOCTYPE html>
<html>

<head>
    <!-- <script type="text/javascript" src="Javascripts\jquery\jquery-1.7.1.min.js"></script> -->
    <script type="text/javascript" src="Javascripts\jquery\jquery-1.8.3.min.js"></script>


    <script type="text/javascript" src="Javascripts\xCheckStudio\SessionManager.js"></script>

    <link href="images/UIPackage/favicon.png" rel="shortcut icon" />
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0" name="viewport" />
    <link href="CSS/newProjectCreationDialog.css" rel="stylesheet" type="text/css" />
    <meta content="Launchpad by Anima" name="author">
    </meta>
</head>

<body style="margin: 0;
 background: rgba(255, 255, 255, 1.0);">
    <input id="anPageName" name="page" type="hidden" value="newprojectcreationdialog" />
    <div class="newprojectcreationdialog">
        <div style="width: 682px; height: 392px; position:relative; margin:auto;">
            <div class="projectcreationdialoggroup">
                <div class="bg">
                </div>
                <div class="properties">
                    <div class="bg1">
                    </div>
                    <div class="properties1">
                        Properties
                    </div>
                    <div class="footer">
                    </div>
                    <div class="textfieldprojectname">
                        <!-- <img src="/images/UIPackage/new-project-creation-dialog-text-field-function.png" class="textfieldprojectname1" /> -->
                        <input type="text" id="inputprojectname" name="ProjectName" class="textfieldprojectname1"
                            style="border: solid 1px; border-radius: 5px;" />
                    </div>
                    <div class="projectname">
                        Project Name
                    </div>
                    <div class="description">
                        <div class="textfielddescription">
                            <!-- <img src="/images/UIPackage/new-project-creation-dialog-text-field-function.png" class="textfielddescription1" /> -->
                            <input type="text" id="descriptionBox" name="description" class="textfielddescription1"
                                style="border: solid 1px;  border-radius: 5px;" />
                        </div>
                        <div class="description1">
                            Description
                        </div>
                    </div>
                    <div class="function">
                        <div class="textfieldfunction">
                            <!-- <img src="/images/UIPackage/new-project-creation-dialog-text-field-function.png" class="textfieldfunction1" /> -->
                            <input type="text" id="functionBox" name="function" class="textfieldfunction1"
                                style="border: solid 1px;  border-radius: 5px;" />
                        </div>
                        <div class="function1">
                            Function
                        </div>
                    </div>
                    <!--PUblic or Private project switch -->
                    <div class="projectscopeswitch">
                        <input type="checkbox" id="projectScopeSwitchId"> System Project<br>
                    </div>

                    <a href="createproject.html">
                        <div class="cancelbtn" style="cursor: pointer;">
                            <img src="images/UIPackage/new-project-creation-dialog-bg@2x.png" class="bg2" />
                            <div class="cancel">
                                Cancel
                            </div>
                        </div>
                    </a>
                    <!--<a href="/checkModule.html">-->
                    <div class="createbtn" id="createbtn" onclick="OnCreateProject()" style="cursor: pointer;">
                        <img src="images/UIPackage/new-project-creation-dialog-bg@2x.png" class="bg2" />
                        <div class="create">
                            Create
                        </div>
                    </div>
                    <!--</a>-->
                </div>
                <div class="header">
                    <div class="bg1">
                    </div>
                    <div class="newproject">
                        NEW PROJECT
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Scripts -->
    <script>
        anima_isHidden = function (e) {
            if (!(e instanceof HTMLElement)) return !1;
            if (getComputedStyle(e).display == "none") return !0; else if (e.parentNode && anima_isHidden(e.parentNode)) return !0;
            return !1;
        };
        anima_loadAsyncSrcForTag = function (tag) {
            var elements = document.getElementsByTagName(tag);
            var toLoad = [];
            for (var i = 0; i < elements.length; i++) {
                var e = elements[i];
                var src = e.getAttribute("src");
                var loaded = (src != undefined && src.length > 0 && src != 'data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==');
                if (loaded) continue;
                var asyncSrc = e.getAttribute("src");
                if (asyncSrc == undefined || asyncSrc.length == 0) continue;
                if (anima_isHidden(e)) continue;
                toLoad.push(e);
            }
            toLoad.sort(function (a, b) {
                return anima_getTop(a) - anima_getTop(b);
            });
            for (var i = 0; i < toLoad.length; i++) {
                var e = toLoad[i];
                var asyncSrc = e.getAttribute("src");
                e.setAttribute("src", asyncSrc);
            }
        };
        anima_pauseHiddenVideos = function (tag) {
            var elements = document.getElementsByTagName("video");
            for (var i = 0; i < elements.length; i++) {
                var e = elements[i];
                var isPlaying = !!(e.currentTime > 0 && !e.paused && !e.ended && e.readyState > 2);
                var isHidden = anima_isHidden(e);
                if (!isPlaying && !isHidden && e.getAttribute("autoplay") == "autoplay") {
                    e.play();
                } else if (isPlaying && isHidden) {
                    e.pause();
                }
            }
        };
        anima_loadAsyncSrc = function (tag) {
            anima_loadAsyncSrcForTag("img");
            anima_loadAsyncSrcForTag("iframe");
            anima_loadAsyncSrcForTag("video");
            anima_pauseHiddenVideos();
        };
        var anima_getTop = function (e) {
            var top = 0;
            do {
                top += e.offsetTop || 0;
                e = e.offsetParent;
            } while (e);
            return top;
        };
        anima_loadAsyncSrc();
        anima_old_onResize = window.onresize;
        anima_new_onResize = undefined;
        anima_updateOnResize = function () {
            if (anima_new_onResize == undefined || window.onresize != anima_new_onResize) {
                anima_new_onResize = function (x) {
                    if (anima_old_onResize != undefined) anima_old_onResize(x);
                    anima_loadAsyncSrc();
                };
                window.onresize = anima_new_onResize;
                setTimeout(function () {
                    anima_updateOnResize();
                }, 3000);
            }
        };
        anima_updateOnResize();
        setTimeout(function () {
            anima_loadAsyncSrc();
        }, 200);
    </script>
    <script>

        function OnCreateProject() {
            var projectname = document.getElementById("inputprojectname").value;
            if (projectname === undefined || projectname === "") {
                alert('Enter project name');
                return;
            }

            setProjectSessionData(projectname).then(function () {
               
                var descriptionText = document.getElementById("descriptionBox").value;
                if (descriptionText == undefined) {
                    descriptionText = "";
                }

                var functionText = document.getElementById("functionBox").value;
                if (functionText == undefined) {
                    functionText = "";
                }

                // project scope value i.e. public or private
                var projectScope = document.getElementById("projectScopeSwitchId").checked;

                // create project database
                createProject(projectname, descriptionText, functionText, projectScope);
            });

        }

        function setProjectSessionData(projectName) {
            return new Promise((resolve) => {
                $.ajax({
                    data: {
                        'InvokeFunction': 'CreateProjectSession',
                        'projectName': projectName,
                        'projectId': "",   // for now send the empty project ID, 
                                           // later in  AddProjectToMainDB() overwrite it                       
                        'loadProject' : 'FALSE',
                        'sourceAPath' : "Projects/"+projectName+"/SourceA",
                        'sourceBPath' : "Projects/"+projectName+"/SourceB"
                    },
                    type: "POST",
                    url: "PHP/ProjectManager.php"
                }).done(function (msg) {                    
                    return resolve(true);
                });
            });
        }

    </script>
    <!-- End of Scripts -->
</body>

</html>